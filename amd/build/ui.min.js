define("tiny_codehighlighter/ui",["exports","core/modal_factory","core/modal_events","./modal"],(function(_exports,_modal_factory,_modal_events,_modal){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * CodeHighlighter for TinyMCE.
   *
   * @module      tiny_codehighlighter/ui
   * @copyright   2023 Nov <m.kowalski.nov7@gmail.com>
   * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.insertCode=_exports.handleAction=_exports.getCodeHLTag=void 0,_modal_factory=_interopRequireDefault(_modal_factory),_modal_events=_interopRequireDefault(_modal_events),_modal=_interopRequireDefault(_modal);_exports.handleAction=editor=>{displayDialog(editor)};const displayDialog=async editor=>{const modal=await _modal_factory.default.create({type:_modal.default.TYPE,templateContext:Object.assign({},{elementid:editor.id},{}),large:!0});modal.show();const $root=await modal.getRoot();let sel=editor.selection.getNode(),codeHLTag=getCodeHLTag(sel);if(codeHLTag&&codeHLTag.querySelectorAll("TD")){document.getElementById("id_content_editor_tiny_codehighlighter").value=codeHLTag.querySelectorAll("TD")[1].innerText}$root.on(_modal_events.default.hidden,(()=>{modal.destroy()})),$root.on(_modal_events.default.save,(()=>{codeHLTag&&codeHLTag.remove(),insertCode(editor)}))},getCodeHLTag=node=>{for(;node&&!node.classList.contains("codehl");)node=node.parentElement;return node};_exports.getCodeHLTag=getCodeHLTag;const insertCode=editor=>{const item=document.getElementById("id_content_editor_tiny_codehighlighter");let lan=document.getElementById("id_content_editor_tiny_codehihlighter_langugage");let splitted=item.value.split(/\r?\n/),lineNumbers="",codeLines="",lineNumer=1,content="";var e;content+='<div class="codehl chLang_'+lan.value+' chParser_JS">',content+='<table class="normal mce-item-table"><thead><tr><th colspan="2"><span class="title"></span>',content+='<span class="language">CodeHL 3.0 [pre-alpha] <b>['+(-1===(e=lan).selectedIndex?null:e.options[e.selectedIndex].text),content+="]</b></span></th></tr></thead><tbody><tr><td>",window.console.log("Language "+lan.value);for(let el in splitted)lineNumbers+="<pre>"+lineNumer+++"</pre>",codeLines+="<pre>"+splitted[el]+"</pre>";content+=lineNumbers,content+="</td><td>",content+=codeLines,content+="</td></tr></tbody></table></div></div><br/>",editor.insertContent(content)};_exports.insertCode=insertCode}));

//# sourceMappingURL=ui.min.js.map